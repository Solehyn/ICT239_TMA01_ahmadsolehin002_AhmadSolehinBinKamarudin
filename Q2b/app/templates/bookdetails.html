{% extends "base.html" %}

{% block page_title %}
BOOK DETAILS
{% endblock %}

{% block mainblock %}
<div class="col-12 mt-2">

    <div class="card mb-2 card-common w-100">
        <div class="card-body p-4">

            <!-- ---------------------------------------------------- -->
            <!-- LAYOUT FOR LARGE/MEDIUM/SMALL SCREENS (Side-by-Side) -->
            <!-- Visible on sm and up (hidden on xs) -->
            <!-- ---------------------------------------------------- -->
            <div class="media d-none d-sm-flex">
                <!-- Image (Left) -->
                <img src="{{ book.url }}" class="mr-4" alt="Cover for {{ book.title }}" 
                     style="width: 200px; height: 300px; object-fit: cover; flex-shrink: 0;">
                
                <!-- Text Details (Right) -->
                <div class="media-body">
                    <h4 class="mt-0 font-weight-bold">{{ book.title }}</h4>
                    <p class="mb-1 text-muted">By {{ book.authors|join(', ') }}</p>
                    <hr>

                    <!-- Book Metadata -->
                    <div class="mb-3">
                        <p class="mb-1"><strong>Category:</strong> {{ book.category }}, {{ book.genres|join(', ') }}</p>
                        <p class="mb-1"><strong>Pages:</strong> {{ book.pages }}</p>
                        <p class="mb-1"><strong>Copies:</strong> {{ book.copies }} <strong>Available:</strong> {{ book.available }}</p>
                    </div>
                    
                    <!-- Full Description -->
                    {% if book.description %}
                        {% for paragraph in book.description %}
                            <p style="text-align: justify;">{{ paragraph }}</p>
                        {% endfor %}
                    {% endif %}
                </div>
            </div>

            <!-- ---------------------------------------------------- -->
            <!-- LAYOUT FOR EXTRA SMALL SCREENS (Image-on-Top) -->
            <!-- Visible on xs (hidden on sm and up) -->
            <!-- ---------------------------------------------------- -->
            <div class="d-block d-sm-none">
                <!-- Image on Top (Centered and takes up card width) -->
                <img src="{{ book.url }}" class="card-img-top mb-2" alt="Cover for {{ book.title }}" style="object-fit: contain;">
                
                <!-- Text Details Below -->
                <div class="mt-3">
                    <h4 class="mt-0 font-weight-bold">{{ book.title }}</h4>
                    <p class="mb-1 text-muted">By {{ book.authors|join(', ') }}</p>
                    <hr>

                    <!-- Book Metadata -->
                    <div class="mb-3">
                        <p class="mb-1"><strong>Category:</strong> {{ book.category }}, {{ book.genres|join(', ') }}</p>
                        <p class="mb-1"><strong>Pages:</strong> {{ book.pages }}</p>
                        <p class="mb-1"><strong>Copies:</strong> {{ book.copies }} <strong>Available:</strong> {{ book.available }}</p>
                    </div>
                    
                    <!-- Full Description -->
                    {% if book.description %}
                        {% for paragraph in book.description %}
                            <p style="text-align: justify;">{{ paragraph }}</p>
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
            
            <!-- Back button at the very bottom right (visible on all screens) -->
            {% if book.available > 0 %}
                <a href="{{ url_for('auth.make_loan', title=book.title) }}" class="btn btn-success float-right ml-2">
                    Make a Loan
                </a>
            {% else %}
                <a href="{{ url_for('auth.make_loan', title=book.title) }}" class="btn btn-danger float-right ml-2">
                    Not Available
                </a>
            {% endif %}
            <a href="{{ url_for('booktitles') }}" class="btn btn-success float-right">Back to Book Titles</a>
        </div>
    </div>
</div>
{% endblock %}

